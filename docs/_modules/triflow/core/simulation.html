

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>triflow.core.simulation &mdash; triflow 0.4.12 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="triflow 0.4.12 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> triflow
          

          
            
            <img src="../../../_static/logo_locie.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../schemes.html">Temporal schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cookbook/displays.html">Displays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute.html">Contribution guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">triflow</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">triflow</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>triflow.core.simulation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for triflow.core.simulation</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># coding=utf8</span>

<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">pprint</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pendulum</span>
<span class="kn">from</span> <span class="nn">coolname</span> <span class="k">import</span> <span class="n">generate_slug</span>
<span class="kn">from</span> <span class="nn">path</span> <span class="k">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">triflow.plugins</span> <span class="k">import</span> <span class="n">container</span><span class="p">,</span> <span class="n">schemes</span>
<span class="kn">from</span> <span class="nn">xarray</span> <span class="k">import</span> <span class="n">Dataset</span>


<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">())</span>
<span class="n">logging</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="Timer"><a class="viewcode-back" href="../../../triflow.core.html#triflow.core.simulation.Timer">[docs]</a><span class="k">class</span> <span class="nc">Timer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">last</span><span class="p">,</span> <span class="n">total</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">last</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">total</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">repr</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">last:   </span><span class="si">{last}</span><span class="s2"></span>
<span class="s2">total:  </span><span class="si">{total}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">last</span><span class="o">=</span><span class="p">(</span><span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">subtract</span><span class="p">(</span>
            <span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">last</span><span class="p">)</span>
            <span class="o">.</span><span class="n">diff</span><span class="p">()),</span>
            <span class="n">total</span><span class="o">=</span><span class="p">(</span><span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">subtract</span><span class="p">(</span>
                <span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="p">)</span>
            <span class="o">.</span><span class="n">diff</span><span class="p">()))</span></div>


<div class="viewcode-block" id="null_hook"><a class="viewcode-back" href="../../../triflow.core.html#triflow.core.simulation.null_hook">[docs]</a><span class="k">def</span> <span class="nf">null_hook</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">pars</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">fields</span><span class="p">,</span> <span class="n">pars</span></div>


<div class="viewcode-block" id="Simulation"><a class="viewcode-back" href="../../../triflow.core.html#triflow.core.simulation.Simulation">[docs]</a><span class="k">class</span> <span class="nc">Simulation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;High level container used to run simulation build on triflow Model.</span>
<span class="sd">      This object is an iterable which will yield every time step until the parameters &#39;tmax&#39; is reached if provided.</span>
<span class="sd">      By default, the solver use a 6th order ROW solver, an implicit method with integrated time-stepping.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      model : triflow.Model</span>
<span class="sd">          Contain finite difference approximation and routine of the dynamical system</span>
<span class="sd">      t : float</span>
<span class="sd">          initial time</span>
<span class="sd">      fields : triflow.BaseFields or dict (any mappable)</span>
<span class="sd">          triflow container or mappable filled with initial conditions</span>
<span class="sd">      physical_parameters : dict</span>
<span class="sd">          physical parameters of the simulation</span>
<span class="sd">      id : None, optional</span>
<span class="sd">          name of the simulation. A 2 word slug will be generated if not provided.</span>
<span class="sd">      hook : callable, optional</span>
<span class="sd">          any callable taking the actual time, fields and parameters and return modified fields and parameters. Will be called every internal time step and can be used to include time dependent or conditionnal parameters, boundary conditions...</span>
<span class="sd">      scheme : callable, optional, default triflow.schemes.RODASPR</span>
<span class="sd">          an callable object which take the simulation state and return the next step. Its signature is scheme.__call__(fields, t, dt, pars, hook) and it should return the next time and the updated fields. It take the model and extra positional and named arguments.</span>
<span class="sd">      *args, **kwargs</span>
<span class="sd">          extra arguments passed to the scheme.</span>
<span class="sd">      *args, **kwargs</span>
<span class="sd">          extra arguments passed to the scheme.</span>

<span class="sd">      Attributes</span>
<span class="sd">      ----------</span>
<span class="sd">      dt : float</span>
<span class="sd">        output time step</span>
<span class="sd">      fields : triflow.Fields</span>
<span class="sd">        triflow container filled with actual data</span>
<span class="sd">      i : int</span>
<span class="sd">        actual iteration</span>
<span class="sd">      id : str</span>
<span class="sd">        name of the simulation</span>
<span class="sd">      model : triflow.Model</span>
<span class="sd">        triflow Model used in the simulation</span>
<span class="sd">      physical_parameters : dict</span>
<span class="sd">        physical parameters of the simulation</span>
<span class="sd">      status : str</span>
<span class="sd">        status of the simulation, one of the following one: (&#39;created&#39;, &#39;running&#39;, &#39;finished&#39;, &#39;failed&#39;)</span>
<span class="sd">      t : float</span>
<span class="sd">        actual time</span>
<span class="sd">      tmax : float or None, default None</span>
<span class="sd">        stopping time of the simulation. Not stopping if set to None.</span>

<span class="sd">      Examples</span>
<span class="sd">      --------</span>
<span class="sd">      &gt;&gt;&gt; import numpy as np</span>
<span class="sd">      &gt;&gt;&gt; import triflow</span>
<span class="sd">      &gt;&gt;&gt; model = triflow.Model([&quot;k1 * dxxU&quot;,</span>
<span class="sd">      ...                        &quot;k2 * dxxV&quot;],</span>
<span class="sd">      ...                       [&quot;U&quot;, &quot;V&quot;],</span>
<span class="sd">      ...                       [&quot;k1&quot;, &quot;k2&quot;])</span>
<span class="sd">      &gt;&gt;&gt; x = np.linspace(0, 100, 1000, endpoint=False)</span>
<span class="sd">      &gt;&gt;&gt; U = np.cos(x * 2 * np.pi / 100)</span>
<span class="sd">      &gt;&gt;&gt; V = np.sin(x * 2 * np.pi / 100)</span>
<span class="sd">      &gt;&gt;&gt; fields = model.fields_template(x=x, U=U, V=V)</span>
<span class="sd">      &gt;&gt;&gt; pars = {&#39;k1&#39;: 1, &#39;k2&#39;: 1, &#39;periodic&#39;: True}</span>
<span class="sd">      &gt;&gt;&gt; simulation = triflow.Simulation(model, 0, fields,</span>
<span class="sd">      ...                                 pars, dt=5, tmax=50)</span>
<span class="sd">      &gt;&gt;&gt; for t, fields in simulation:</span>
<span class="sd">      ...    pass</span>
<span class="sd">      &gt;&gt;&gt; print(t)</span>
<span class="sd">      50</span>
<span class="sd">      &quot;&quot;&quot;</span>  <span class="c1"># noqa</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">physical_parameters</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span>
                 <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hook</span><span class="o">=</span><span class="n">null_hook</span><span class="p">,</span>
                 <span class="n">scheme</span><span class="o">=</span><span class="n">schemes</span><span class="o">.</span><span class="n">RODASPR</span><span class="p">,</span>
                 <span class="n">time_stepping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">init_bokeh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">tmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">intersection_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">function</span><span class="p">):</span>
            <span class="n">func_signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
            <span class="n">func_parameters</span> <span class="o">=</span> <span class="n">func_signature</span><span class="o">.</span><span class="n">parameters</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span>
                      <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span>
                      <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">func_parameters</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">kwargs</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;time_stepping&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_stepping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">generate_slug</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">id</span> <span class="k">else</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">physical_parameters</span> <span class="o">=</span> <span class="n">physical_parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fields_template</span><span class="p">(</span><span class="o">**</span><span class="n">fields</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="o">=</span> <span class="n">tmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span> <span class="o">=</span> <span class="n">scheme</span><span class="p">(</span><span class="n">model</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">intersection_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span>
                                                    <span class="n">scheme</span><span class="o">.</span><span class="fm">__init__</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">time_stepping</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">schemes</span><span class="o">.</span><span class="n">RODASPR</span><span class="p">,</span>
                                 <span class="n">schemes</span><span class="o">.</span><span class="n">ROS3PRL</span><span class="p">,</span>
                                 <span class="n">schemes</span><span class="o">.</span><span class="n">ROS3PRw</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span> <span class="o">=</span> <span class="n">schemes</span><span class="o">.</span><span class="n">time_stepping</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">,</span>
                <span class="o">**</span><span class="n">intersection_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span>
                                      <span class="n">schemes</span><span class="o">.</span><span class="n">time_stepping</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;created&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_total_running</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_running</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_created_timestamp</span> <span class="o">=</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actual_timestamp</span> <span class="o">=</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hook</span> <span class="o">=</span> <span class="n">hook</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_displays</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handler</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bokeh_layout</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_probes_info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_bokeh</span> <span class="o">=</span> <span class="n">init_bokeh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_probe</span><span class="p">(</span><span class="s2">&quot;ctime&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">simul</span><span class="p">:</span> <span class="n">simul</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">last</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_probe</span><span class="p">(</span><span class="s2">&quot;full_ctime&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">simul</span><span class="p">:</span> <span class="n">simul</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">total</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compute_probes</span><span class="p">()</span>

<div class="viewcode-block" id="Simulation.compute"><a class="viewcode-back" href="../../../triflow.core.html#triflow.core.simulation.Simulation.compute">[docs]</a>    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generator which yield the actual state of the system every dt.</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        tuple : t, fields</span>
<span class="sd">            Actual time and updated fields container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">physical_parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started_timestamp</span> <span class="o">=</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displays</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="k">import</span> <span class="n">push_notebook</span><span class="p">,</span> <span class="n">show</span>
            <span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="k">import</span> <span class="n">Column</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handler</span> <span class="o">=</span> <span class="n">show</span><span class="p">(</span><span class="n">Column</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_bokeh_layout</span><span class="p">),</span>
                                 <span class="n">notebook_handle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">display</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displays</span><span class="p">:</span>
                <span class="n">display</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">probes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="p">)</span>
            <span class="n">push_notebook</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handler</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_end_simul</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="n">fields</span><span class="p">,</span> <span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hook</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">pars</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="o">-</span> <span class="n">t</span>
                           <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">)</span>
                           <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
                <span class="n">before_compute</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span>
                <span class="n">t</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span>
                                         <span class="n">pars</span><span class="p">,</span> <span class="n">hook</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_hook</span><span class="p">)</span>
                <span class="n">after_compute</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_running</span> <span class="o">=</span> <span class="n">after_compute</span> <span class="o">-</span> <span class="n">before_compute</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_total_running</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_running</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">physical_parameters</span> <span class="o">=</span> <span class="n">pars</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actual_timestamp</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_actual_timestamp</span> <span class="o">=</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_compute_probes</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">probes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displays</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">display</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displays</span><span class="p">:</span>
                        <span class="n">display</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">probes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="p">)</span>
                    <span class="n">push_notebook</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handler</span><span class="p">)</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span>

        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;failed&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;failed&quot;</span>
            <span class="k">raise</span></div>

    <span class="k">def</span> <span class="nf">_end_simul</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;finished&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">repr</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="si">{simul_name:=^30}</span><span class="s2"></span>

<span class="s2">created:      </span><span class="si">{created_date}</span><span class="s2"></span>
<span class="s2">started:      </span><span class="si">{started_date}</span><span class="s2"></span>
<span class="s2">last:         </span><span class="si">{last_date}</span><span class="s2"></span>

<span class="s2">time:         </span><span class="si">{t:g}</span><span class="s2"></span>
<span class="s2">iteration:    </span><span class="si">{iter:g}</span><span class="s2"></span>

<span class="s2">last step:    </span><span class="si">{step_time}</span><span class="s2"></span>
<span class="s2">total time:   </span><span class="si">{running_time}</span><span class="s2"></span>

<span class="s2">container:    </span><span class="si">{container}</span><span class="s2"></span>

<span class="s2">Physical parameters</span>
<span class="s2">-------------------</span>
<span class="si">{parameters}</span><span class="s2"></span>

<span class="s2">Hook function</span>
<span class="s2">-------------</span>
<span class="si">{hook_source}</span><span class="s2"></span>

<span class="s2">=========== Model ===========</span>
<span class="si">{model_repr}</span><span class="s2"></span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="nb">repr</span> <span class="o">=</span> <span class="nb">repr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">simul_name</span><span class="o">=</span><span class="s2">&quot; </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                           <span class="n">parameters</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                               <span class="p">[(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span>
                                <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span>
                                <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">physical_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()]),</span>
                           <span class="n">t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                           <span class="nb">iter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span>
                           <span class="n">model_repr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                           <span class="n">hook_source</span><span class="o">=</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hook</span><span class="p">),</span>
                           <span class="n">step_time</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_running</span> <span class="k">else</span>
                                      <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                                      <span class="o">.</span><span class="n">subtract</span><span class="p">(</span>
                                          <span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_running</span><span class="p">)</span>
                                      <span class="o">.</span><span class="n">diff</span><span class="p">()),</span>
                           <span class="n">running_time</span><span class="o">=</span><span class="p">(</span><span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                                         <span class="o">.</span><span class="n">subtract</span><span class="p">(</span>
                               <span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_total_running</span><span class="p">)</span>
                               <span class="o">.</span><span class="n">diff</span><span class="p">()),</span>
                           <span class="n">container</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_container</span>
                                      <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">path</span><span class="p">),</span>
                           <span class="n">created_date</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_created_timestamp</span>
                                         <span class="o">.</span><span class="n">to_cookie_string</span><span class="p">()),</span>
                           <span class="n">started_date</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_started_timestamp</span>
                                         <span class="o">.</span><span class="n">to_cookie_string</span><span class="p">()</span>
                                         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started_timestamp</span>
                                         <span class="k">else</span> <span class="s2">&quot;None&quot;</span><span class="p">),</span>
                           <span class="n">last_date</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span>
                                      <span class="o">.</span><span class="n">to_cookie_string</span><span class="p">()</span>
                                      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_timestamp</span>
                                      <span class="k">else</span> <span class="s2">&quot;None&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">repr</span>

<div class="viewcode-block" id="Simulation.add_display"><a class="viewcode-back" href="../../../triflow.core.html#triflow.core.simulation.Simulation.add_display">[docs]</a>    <span class="k">def</span> <span class="nf">add_display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="o">*</span><span class="n">display_args</span><span class="p">,</span> <span class="o">**</span><span class="n">display_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a display for the simulation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        display : callable</span>
<span class="sd">            a display as the one available in triflow.displays</span>
<span class="sd">        *display_args</span>
<span class="sd">            positional arguments for the display function (other than the simulation itself)</span>
<span class="sd">        **display_kwargs</span>
<span class="sd">            named arguments for the display function</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_bokeh</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="k">import</span> <span class="n">output_notebook</span>
            <span class="n">output_notebook</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_bokeh</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">display</span> <span class="o">=</span> <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="o">*</span><span class="n">display_args</span><span class="p">,</span>
                          <span class="o">**</span><span class="n">display_kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_displays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bokeh_layout</span> <span class="o">+=</span> <span class="n">display</span><span class="o">.</span><span class="n">figs</span></div>

<div class="viewcode-block" id="Simulation.attach_container"><a class="viewcode-back" href="../../../triflow.core.html#triflow.core.simulation.Simulation.attach_container">[docs]</a>    <span class="k">def</span> <span class="nf">attach_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;output/&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
                         <span class="n">nbuffer</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a Container to the simulation which allows some</span>
<span class="sd">        persistance to the simulation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            path for the container</span>
<span class="sd">        mode : str, optional</span>
<span class="sd">            &quot;a&quot; or &quot;w&quot;</span>
<span class="sd">        nbuffer : int, optional</span>
<span class="sd">            wait until nbuffer data in the Queue before save on disk.</span>
<span class="sd">        timeout : int, optional</span>
<span class="sd">            wait until timeout since last flush before save on disk.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compute_probes</span><span class="p">()</span>
        <span class="n">container_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span>
            <span class="n">container_path</span><span class="p">,</span>
            <span class="n">t0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
            <span class="n">initial_fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span>
            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">,</span>
                          <span class="n">timestamp</span><span class="o">=</span><span class="s2">&quot;{:%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S}&quot;</span>
                          <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_created_timestamp</span><span class="p">),</span>
                          <span class="n">hook</span><span class="o">=</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hook</span><span class="p">),</span>
                          <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">physical_parameters</span><span class="p">),</span>
            <span class="n">probes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_probes</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
            <span class="n">nbuffer</span><span class="o">=</span><span class="n">nbuffer</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Persistent container attached (</span><span class="si">%s</span><span class="s2">)&quot;</span>
                     <span class="o">%</span> <span class="n">container_path</span><span class="o">.</span><span class="n">abspath</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;created&quot;</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_running</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_running</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">)</span>

<div class="viewcode-block" id="Simulation.add_probe"><a class="viewcode-back" href="../../../triflow.core.html#triflow.core.simulation.Simulation.add_probe">[docs]</a>    <span class="k">def</span> <span class="nf">add_probe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">probe</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_probes_info</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">probe</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_compute_probes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_probes</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">data_vars</span><span class="o">=</span><span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="p">[</span><span class="n">probe</span><span class="p">(</span><span class="bp">self</span><span class="p">)])</span>
                                          <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">probe</span><span class="p">)</span>
                                          <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probes_info</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
                               <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">],</span>
                                       <span class="o">**</span><span class="p">{</span><span class="n">coord</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span>
                                          <span class="k">for</span> <span class="n">coord</span>
                                          <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_indep_vars</span><span class="p">}})</span>

<div class="viewcode-block" id="Simulation.timer_probe"><a class="viewcode-back" href="../../../triflow.core.html#triflow.core.simulation.Simulation.timer_probe">[docs]</a>    <span class="k">def</span> <span class="nf">timer_probe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_running</span></div></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Nicolas Cellier.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.4.12',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>